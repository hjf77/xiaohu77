<script type="text/javascript">
    <!--
    $(function () {
        _task_candidate_win = $('#task-candidate-win').window({
            //href:'${basePath}/wf/procdef/procdef!forTaskListenerConfig.action',
            closed: true,
            //cache:false,
            draggable: false,
            collapsible: false,
            minimizable: false,
            maximizable: false,
            modal: true,
            shadow: true
        });
        _task_candidate_groups_list = $('#task-candidate-groups-list').datagrid({
            title: "候选组",
            singleSelect: true,
            height: 450,
            rownumbers: true,
            striped: true,
            toolbar: [{
                text: '新增',
                iconCls: 'icon-add',
                handler: function () {
                    _task_candidate_win.window('open');
                    _task_candidate_win.window('setTitle', '候选组');
                    _task_candidate_win.window('refresh', '${basePath}/b/page-work_flow/addCandidateGroup');
                }
            }]
        });
        loadTaskCandidateGroups();
    });

    function candidateGroupsBtFormatter(value, rowData, rowIndex) {
        var roleName = rowData.roleName;
        var d = '<img onclick="deleteCandidateGroup(\'' + roleName + '\')" src="${basePath}/page/work_flow/image/delete.gif" title="' + "删除" + '" style="cursor:hand;"/>';
        return d;
    }

    function deleteCandidateGroup(name) {
        task.deleteCandidateGroup(name);
        loadTaskCandidateGroups();
    }

    function loadTaskCandidateGroups() {
        var candidateGroups = task.candidateGroups;
        var candidate_groups_grid_rows = [];
        //alert(listeners.getSize());
        for (var i = 0; i < candidateGroups.getSize(); i++) {
            debugger
            var candidateGroup = candidateGroups.get(i);
            var group = {
                roleName: candidateGroup,
                action: ''
            };
            candidate_groups_grid_rows[i] = group;
        }
        ;
        //alert(listener_grid_rows);
        var candidate_groups_grid_data = {
            total: candidateGroups.getSize(),
            rows: candidate_groups_grid_rows
        };
        _task_candidate_groups_list.datagrid('loadData', candidate_groups_grid_data);
    }

    //-->
</script>
<!--<div id="task-candidate-groups-panel">-->
<table id="task-candidate-groups-list" name="task-candidate-groups-list">
    <thead>
    <tr>
        <th field="roleName" width="100" align="middle" sortable="false">角色名称</th>
        <th field="action" width="80" align="center" formatter="candidateGroupsBtFormatter">操作</th>
    </tr>
    </thead>
</table>
<!--</div>-->
