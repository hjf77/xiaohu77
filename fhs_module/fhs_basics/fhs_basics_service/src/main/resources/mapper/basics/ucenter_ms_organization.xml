<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.fhs.basics.mapper.UcenterMsOrganizationMapper">
    <select id="findRank" resultType="java.lang.Integer" parameterType="map">

                SELECT MAX(ranking)
                FROM t_ucenter_ms_organization
                WHERE parent_id = #{parentId}

    </select>

    <select id="selectOrgTreeByCentralStat" resultType="com.fhs.basics.vo.UcenterMsOrganizationVO">

                SELECT id,name,parent_id,ranking,is_enable,group_code,ext_json,is_company,company_id,is_pipeline,create_user,create_time,update_user,update_time,is_delete
                FROM t_ucenter_ms_organization WHERE is_delete = 0 AND (is_pipeline = 0 or ISNULL(is_pipeline));

    </select>

    <select id="selectOrgTreeByOpeArea" resultType="com.fhs.basics.vo.UcenterMsOrganizationVO">

                SELECT id,name,parent_id,ranking,is_enable,group_code,ext_json,is_company,company_id,is_pipeline,create_user,create_time,update_user,update_time,is_delete
                FROM t_ucenter_ms_organization WHERE is_delete = 0 AND (is_pipeline = 0 or ISNULL(is_pipeline)) <![CDATA[AND CHAR_LENGTH (id)<=12
        ]]>
    </select>

    <select id="selectOrgTree" resultType="com.fhs.basics.po.UcenterMsOrganizationPO">
        SELECT
        id,name,parent_id,ranking,is_enable,group_code,ext_json,is_company,company_id,is_pipeline,create_user,create_time,update_user,update_time,is_delete
        FROM t_ucenter_ms_organization WHERE is_delete = 0 AND (is_pipeline = 0 or ISNULL(is_pipeline))
        and id like CONCAT('' #{organizationId}, '%')
        <if test="orgLevel!= null and orgLevel != '' and orgLevel == 'oilpro'">
            <![CDATA[AND CHAR_LENGTH (id)<=9]]>
        </if>
        <if test="orgLevel!= null and orgLevel != '' and orgLevel == 'opeArea'">
            <![CDATA[AND CHAR_LENGTH (id)<=12]]>
        </if>

        <if test="orgLevel!= null and orgLevel != '' and orgLevel == 'centralStat'">
            <![CDATA[AND CHAR_LENGTH (id)<=15]]>
        </if>
    </select>

    <select id="selectOrg" resultType="com.fhs.basics.po.UcenterMsOrganizationPO">
        SELECT
        id,name,parent_id,ranking,is_enable,group_code,ext_json,is_company,company_id,is_pipeline,create_user,create_time,update_user,update_time,is_delete
        FROM t_ucenter_ms_organization WHERE is_delete = 0 AND (is_pipeline = 0 or ISNULL(is_pipeline))
        <if test="orgLevel!= null and orgLevel != '' and orgLevel == 'oilpro'">
            <![CDATA[AND CHAR_LENGTH (id)=9]]>
        </if>
        <if test="orgLevel!= null and orgLevel != '' and orgLevel == 'opeArea'">
            <![CDATA[AND CHAR_LENGTH (id)=12]]>
        </if>

        <if test="orgLevel!= null and orgLevel != '' and orgLevel == 'centralStat'">
            <![CDATA[AND CHAR_LENGTH (id)=15]]>
        </if>
    </select>
</mapper>
